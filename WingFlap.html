<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">
  <link rel="icon" href="favicon.ico">

  <title>ProfEd NRMS</title>
  <link href="css/bootstrap.css" rel="stylesheet">
  <link href="css/dashboard.css" rel="stylesheet">
  <link href="css/bootstrap-slider.min.css" rel="stylesheet">
</head>

<body>
  <nav class="navbar navbar-dark fixed-top bg-primary flex-md-nowrap p-0 shadow">
    <a class="navbar-brand col-12" href="#">Aeroacoustics: Noise Reduction Strategies for Mechanical Systems</a>
  </nav>

  <div class="container-fluid">
    <div class="row">
      <nav class="col-md-2 d-none d-md-block bg-light sidebar">
        <div class="sidebar-sticky">
          <ul class="nav flex-column">

            <li class="nav-item">
              <a class="nav-link"   href="index.html" target="_self">
                <span data-feather="file"></span>
                Jet noise - Lighthill's analogy
                <span class="sr-only">(current)</span>
              </a>
            </li>

            <li class="nav-item">
              <a class="nav-link "  href="WindTurbine1.html"  target="_self">
                <span data-feather="file"></span>
                Wind turbine noise - surface pressure fluctuations
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link "  href="WindTurbine2.html"  target="_self">
                <span data-feather="file"></span>
                Wind turbine noise - predicted noise in the far field
              </a>
            </li>

            <li class="nav-item">
              <a class="nav-link"  href="Propeller.html"  target="_self">
                <span data-feather="file"></span>
                Propeller noise - tonal components
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link active"  href="WingFlap.html"  target="_self">
                <span data-feather="file"></span>
                Cavity noise - frequency analysis
              </a>
            </li>

          </ul>
        </div>
      </nav>

      <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-4">
        <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
          <h1 class="h2">Cavity noise - frequency analysis</h1>
          <div class="btn-toolbar mb-2 mb-md-0">
            <div class="btn-group mr-2">
              <button class="btn btn-sm btn-outline-secondary active" onclick="caseAction(this)">Case 1: Mach number effect </button>
              <button class="btn btn-sm btn-outline-secondary" onclick="caseAction(this)">Case 2: Cavity shape </button>
            </div>
          </div>
        </div>

        <blockquote class="blockquote text-justify">
          <p><font size="3">The absolute levels of the noise generated by the flow on top of cavities is particularly difficult to be predicted. On the other side, the frequency distribution of the 
		                         tonal components can be anticipated from the aeroacoustic resonance of the feedback loop created between the flow field travelling downstream
		  			 of the cavity and the acoustic wave travelling upstream. In the present examples, we study the parameters of Rossiter's formula, by varying showing the response 
		  			 of the Sthrouhal at which we get the resonance effect. Consecutive mode numbers determine different flow excitations corresponding to different acoustic harmonics.
		  			 Typically, the loudest contributions correspond to first few fluid modes. As the mode number increases, the St at which you will hear the tonal component also increases.
		  			 For typical applications the first 3-5 fluid dynamic modes are the ones to be avoided. Data and formulas are obtained from:
	  </p>
          <p><font size="3"; style="color:blue"> Rossiter J.E., 1964, Wind-tunnel experiments on the flow over rectangular cavities at subsonic and transonic speeds, Aeronautical Research Council Reports and Memoranda, Technical Report 3438.
		  </p>  
        </blockquote>
	      
        <div class="row">
          <div class="col"><img style="width:660px;height:110px" src="img/wing-flap/formula.png" alt=""></div>

          <div class="col">
            <img style="width:180px;height:70px" src="img/click.png" alt="" data-toggle="modal" data-target="#exampleModal">
          </div>
        </div>

        <!-- Title and conditions  -->
        <div class="row" style="margin-top:30px;">
          <div class="col">
            <h4 id="caseTitle" class="text-primary">Case 1: Mach number effect</h4>
          </div>
        </div>
        <div class="row" style="margin-bottom:30px;">
          <div class="col-12">
            <h6 id="caseDesc">The Strouhal corresponding to the resonant frequencies (i.e. tonal noise heard) is plotted versus a varying Mach number in the equation.</h6>
          </div>
        </div>

        <div id="container" style="width: 60% margin: 0 auto"></div>


        <div id="sliderCase1Area">
          <div class="row">
            <div class="col-1">Mode 1, L/D:
            </div>
            <div class="col-11">
              <input id="sliderCase11" type="text" style="width:90%;padding-left: 100px;" data-slider-min="-1"
                data-slider-max="13" data-slider-step="1" data-slider-value="-1" />
            </div>
          </div>

          <div class="row">
            <div class="col-1">Mode 2, L/D:
            </div>
            <div class="col-11">
              <input id="sliderCase12" type="text" style="width:90%;padding-left: 100px;" data-slider-min="-1"
                data-slider-max="13" data-slider-step="1" data-slider-value="-1" />
            </div>
          </div>

          <div class="row">
            <div class="col-1">Mode 3, L/D:
            </div>
            <div class="col-11">
              <input id="sliderCase13" type="text" style="width:90%;padding-left: 100px;" data-slider-min="-1"
                data-slider-max="13" data-slider-step="1" data-slider-value="-1" />
            </div>
          </div>

        </div>
        <div id="sliderCase2Area"  style="display:none">
          <div class="row">
            <div class="col-1"> </div>
            <div class="col-11">
              <input id="sliderCase21" type="text" style="width:90%;padding-left: 100px;" data-slider-min="-1"
                data-slider-max="9" data-slider-step="1" data-slider-value="-1" />
            </div>
          </div>
        </div>
    </div>

    </main>
  </div>
  </div>

  <!-- Modal -->
  <div class="modal fade" style="top:100px;left:-200px;" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
      <img style="width:800px;height:600px" src="img/wing-flap/explain.png" alt="">
    </div>
  </div>

  <script src="js/jquery.min.js"></script>
  <script src="js/popper.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/bootstrap-slider.js"></script>
  <script src="https://code.highcharts.com/highcharts.js"></script>
  <script src="https://code.highcharts.com/modules/exporting.js"></script>

  <!-- icons -->
  <script src="https://unpkg.com/feather-icons/dist/feather.min.js"></script>
  <script>
    feather.replace();
  </script>
  <!-- icons end -->

  <script>
    var sidebtn = function (nav) {
      console.log($(nav));
          }
  </script>


  <!-- 初始化数据 -->
  <script>
    let cases = [{title: 'Case 1: Mach number effect',
		  desc:'The Strouhal corresponding to the resonant frequencies (i.e. tonal noise heard) is plotted versus a varying Mach number in the equation.'},
      {title: 'Case 2: Cavity shape',
        desc: 'The Strouhal corresponding to the resonant frequencies (i.e. tonal noise heard) is plotted versus the L/D ratio of a cavity with flow at M=0.5. We consider here the loudest mode 1.'}]
    let case11Data = [
		[0, 0.40],
		[0.1, 0.37],
		[0.2, 0.35],
		[0.3, 0.34],
		[0.4 ,0.32],
		[0.5, 0.3],
		[0.6, 0.29],
		[0.7, 0.28],
		[0.8, 0.27],
		[0.9, 0.26],
		[1.0, 0.25],
		[1.1, 0.24],
		[1.2, 0.23],
		[1.3, 0.22]
    ];
    let case12Data = [
		[0, 0.98],
		[0.1, 0.92],
		[0.2, 0.87],
		[0.3, 0.83],
		[0.4, 0.79],
		[0.5, 0.76],
		[0.6, 0.73],
		[0.7, 0.70],
		[0.8, 0.67],
		[0.9, 0.65],
		[1.0, 0.63],
		[1.1, 0.61],
		[1.2, 0.6],
		[1.3, 0.58]
    ]
    let case13Data = [
		[0,1.6],
		[0.1,1.46],
		[0.2,1.39],
		[0.3,1.32],
		[0.4,1.26],
		[0.5,1.21],
		[0.6,1.15],
		[0.7,1.11],
		[0.8,1.07],
		[0.9,1.03],
		[1,1.01],
		[1.1,0.97],
		[1.2,0.94],
		[1.3,0.91]
    ]
    let case21Data = [
		[1,0.41],
		[2,0.4],
		[3,0.37],
		[4,0.34],
		[5,0.31],
		[6,0.27],
		[7,0.24],
		[8,0.21],
		[9,0.18],
		[10,0.17]
    ]
  </script>

  <!--  case 按钮切换 -->
  <script>
    function caseAction(caseBtn) {
      console.log('case', $(caseBtn).text());
      let btnText = $(caseBtn).text().trim();
      if ( cases[0].title=== btnText) {

        var chart_length = chart.series.length;
        for(var i=0;i<chart_length;i++)
        {
          chart.series[0].remove();
        }

        chart.addSeries({
          data: [],
          name: 'Mode 1, n=1',
          marker:{symbol:'circle',fillColor:'red'},
        });

        chart.addSeries({
          data: [],
          name: 'Mode 2, n=2',
          marker:{symbol:'circle',fillColor:'#70C1B3'},
        });
        chart.addSeries({
          data: [],
          name: 'Mode 3, n=3',
          marker:{symbol:'circle',fillColor:'#247BA0'}
        });

        $('.btn-outline-secondary').removeClass('active');
        $('.btn-outline-secondary').eq(0).addClass('active');
        $('#caseTitle').text(cases[0].title);
        $('#caseDesc').text(cases[0].desc);
        $('#sliderCase1Area').show();
        $('#sliderCase2Area').hide();
        // $('#sliderCase21').silder({value:0});

        chart.yAxis[0].update({
          max: 1.5,
          min: -0.1
        });
        chart.xAxis[0].update({
          max: 1.3,
          min: -0.1
        });

        $("#sliderCase11").slider('refresh');
        $("#sliderCase12").slider('refresh');
        $("#sliderCase13").slider('refresh');

      }else if (cases[1].title === btnText) {

        chart.series[0].setData([]);
        chart.yAxis[0].update({
          max: 0.5,
          min: 0
        });
        chart.xAxis[0].update({
          max: 11,
          min: 1
        });
        $('.btn-outline-secondary').removeClass('active');
        $('.btn-outline-secondary').eq(1).addClass('active');
        $('#caseTitle').text(cases[1].title);
        $('#caseDesc').text(cases[1].desc);
        $('#sliderCase1Area').hide();
        $('#sliderCase2Area').show();
        //设置hightcharts
        var chart_length = chart.series.length;
        for(var i=0;i<chart_length;i++)
        {
          chart.series[0].remove();
        }

        chart.addSeries({
          data: [],
          name: 'L/D',
          showInLegend: true,
          marker:{symbol:'circle',fillColor:'red'},
        });

        $("#sliderCase21").slider('refresh');
        // $('#sliderCase1').attr('data-slider-value',-1);
      }
    }
  </script>

  <!-- 滚动条事件 -->
  <script>
    let data11 = [],
      data12 = [],
      data13 = [],
      data21 = [];
    $("#sliderCase11").slider();
    $("#sliderCase12").slider();
    $("#sliderCase13").slider();
    $("#sliderCase21").slider();

    $("#sliderCase11").on("slide", function (slideEvt) {
      if (-1 === slideEvt.value) {
        data = [];
        chart.series[0].setData(data);
      }

      else
      {
        data=[];
        for(var i=0;i<=slideEvt.value;i++)
        data.push(case11Data[i]);
        chart.series[0].setData(data);
      }
    });

    $("#sliderCase12").on("slide", function (slideEvt) {
      // console.log('sliderCase21', slideEvt.value)
      if (-1 === slideEvt.value) {
        data = [];
        chart.series[1].setData(data);
      }

      else
      {
        data=[];
        for(var i=0;i<=slideEvt.value;i++)
        data.push(case12Data[i]);
        chart.series[1].setData(data);
      }
    });

    $("#sliderCase13").on("slide", function (slideEvt) {
      if (-1 === slideEvt.value) {
        data = [];
        chart.series[2].setData(data); }
      else
      {
        data=[];
        for(var i=0;i<=slideEvt.value;i++)
        data.push(case13Data[i]);
        chart.series[2].setData(data);
      }
    });

    $("#sliderCase21").on("slide", function (slideEvt) {
    	// console.log('sliderCase21')
      if (-1 === slideEvt.value) {
        data = [];
        chart.series[0].setData(data);
      }

      else
      {
        data=[];
        for(var i=0;i<=slideEvt.value;i++)
        data.push(case21Data[i]);
        chart.series[0].setData(data);
      }
    });

  </script>

  <!-- highcharts -->
  <script>
    Highcharts.setOptions({
      colors: ['#70C1B3', '#247BA0', '#F3FFBD', '#B2DBBF']
    });
    var chart = Highcharts.chart('container', {
      credits: {
        enabled: false
      }, //去掉版权
      chart: {
        type: 'scatter',
        zoomType: 'xy'
      },
      title: {
        text: ' '
      },
      subtitle: {
        text: ' '
      },
      xAxis: {
        title: {
          enabled: true,
          text: 'Mach'
        },
        startOnTick: true,
        endOnTick: true,
        showLastLabel: true,
        max: 1.3,
        min: 0
      },
      yAxis: {
        title: {
          text: 'St'
        },
        max: 1.6,
        min: 0
      },
      legend: {
        layout: 'vertical',
        align: 'left',
        verticalAlign: 'top',
        x: 100,
        y: 10,
        floating: true,
        // backgroundColor: (Highcharts.theme && Highcharts.theme.legendBackgroundColor) || '#FFFFFF',
        borderWidth: 1
      },
      plotOptions: {
        scatter: {
          marker: {
            radius: 5,
            fillColor:'#FF1654',
            states: {
              hover: {
                enabled: true,
                lineColor: 'rgb(100,100,100)'
              }
            }
          },
          states: {
            hover: {
              marker: {
                enabled: false
              }
            }
          },
          tooltip: {
            headerFormat: '<b>{series.name}</b><br>',
            pointFormat: 'Mach:{point.x}, St:{point.y}'
          }
        }
      },
      series: [{
        name: 'Mode 1, n=1',
        color: 'rgba(223, 83, 83, .5)',
        data: []  }]
    });

    chart.addSeries({
      data: [],
      name: 'Mode 2, n=2',
      marker:{symbol:'circle',fillColor:'#70C1B3'},
    });
    chart.addSeries({
      data: [],
      name: 'Mode 3, n=3',
      marker:{symbol:'circle',fillColor:'#247BA0'} });
  </script>

</body>

</html>
